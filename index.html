<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
    <title>Title</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <link rel="stylesheet" type="text/css" href="animate.css" />

</head>
<body>

    <div id="test1"></div>
    <div id="test2"></div>
    <div id="test3"></div>
    <div id="test4"></div>
    <div id="test5"></div>
    <div id="test6"></div>
<script>
    document.documentElement.style.fontSize = document.documentElement.clientWidth / 7.5 + 'px';</script>
<script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.js"></script>
<script>

;(function(win){

    var Anictr = function(opts){
        this.ele = opts.ele;
        this.ani = opts.ani;
        this.dur = opts.dur;

        if(opts.before){
            this.before = opts.before;
        }
        if(opts.after){
            this.after = opts.after;
        }
        if(opts.rani){
            this.rani = opts.rani;
        }
    };

    Anictr.prototype = {
        go: function(){
            var self = this;
            var ele = document.querySelector(self.ele);
            if(self.before){
                self.before(self)
            }
            if(self.after){
                setTimeout(function(){
                    self.after()
                },self.dur)
            }
            if(self.dur){
                var second = self.dur /1000 + 's';
                ele.style.cssText += ';animation-duration:' + second + ';-webkit-animation-duration:' + second;
            }

            //删除原来的动画特效
            if(self.rani){
                var classNames = ele.className.trim();
                classNames = classNames.replace(/\s+/g,' ')
                var classNameArr = classNames.split(' ');
                for(var i = 0; i<classNameArr.length; i++){
                    if(self.rani === classNameArr[i]){
                        classNameArr.splice(i,1)

                    }
                }
                ele.className = classNameArr.join(' ');
            }

            if(/animated/.test(ele.className)){
                ele.className +=  ' ' + self.ani;
            }else{
                ele.className += ' animated ' + self.ani;
            }

            return self;
        },
        then: function(arr,timeDelay){
            var self = this;
            var ele = document.querySelector(self.ele);

            //then参数可以是多个对象组成的数组
            if(arr.length != undefined){
                setTimeout(function(){
                    for(var j = 0; j<arr.length; j++){
                        arr[j].go.call(arr[j])
                    }
                },timeDelay);

                return arr[arr.length - 1];
            }else{
                setTimeout(function(){
                    arr.go.call(arr)
                },timeDelay);

                return arr;
            }
        }
    }

    var anictr = function(opts){
        return new Anictr(opts)
    }
    win.anictr = anictr;
})(window,undefined);

anictr({
        ele:'#test1',
        ani:'zoomOut',
        dur:500,
        before:function(){console.log('haha')},
        after:function(){console.log('hehe')}
    }).go().then(
            [anictr({
                ele:'#test1',
                rani:'zoomOut',
                ani:'zoomIn',
                dur:1000
            }),anictr({
                ele:'#test6',
                ani:'zoomOutUp',
                dur:1500
            })],500
    ).then(
            anictr({
               ele:'#test2',
               ani:'zoomOut',
               dur:1200
           }),1500
    ).then(
            [anictr({
                ele:'#test3',
                ani:'zoomOutUp',
                dur:1500,
                after:function(){console.log('方贤正')}
            })],2700
    );



</script>
</body>
</html>